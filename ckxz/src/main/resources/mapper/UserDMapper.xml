<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.app.ckxz.userb.mapper.UserDMapper">
    <resultMap id="BaseResultMap" type="com.app.ckxz.userb.moder.UserD">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" property="id" javaType="Long"/>
        <result column="uuid" property="uuid" javaType="String"/>
        <result column="user_img" property="userImg" javaType="String"/>
        <result column="user_id" property="userId" javaType="String"/>
        <result column="password" property="password" javaType="String"/>
        <result column="nickname" property="nickname" javaType="String"/>
        <result column="phone_info" property="phoneInfo" javaType="String"/>
        <result column="connect_mode" property="connectMode" javaType="Integer"/>
        <result column="app_id" property="appId" javaType="String"/>
        <result column="created_time" property="createdTime" javaType="Date"/>
        <result column="card_id" property="cardId" javaType="String"/>
        <result column="wechat_openid" property="wechatOpenid" javaType="String"/>
        <result column="wechat_unionid" property="wechatUnionid" javaType="String"/>
        <result column="app_version" property="appVersion" javaType="String"/>
        <result column="last_login_time" property="lastLoginTime" javaType="Date"/>
        <result column="last_active_time" property="lastActiveTime" javaType="Date"/>
        <result column="is_master" property="isMaster" javaType="Integer"/>
        <result column="real_name" property="realName" javaType="String"/>
        <result column="birthday" property="birthday" javaType="Date"/>
        <result column="introduce" property="introduce" javaType="String"/>
        <result column="address" property="address" javaType="String"/>
        <result column="sex" property="sex" javaType="String"/>
        <result column="wx_profile" property="wxProfile" javaType="String"/>
        <result column="dock_pkid" property="dockPkid" javaType="String"/>
        <result column="dock_pkid2" property="dockPkid2" javaType="String"/>
        <result column="room_number" property="roomNumber" javaType="String"/>
        <result column="home_address" property="homeAddress" javaType="String"/>
        <result column="age" property="age" javaType="String"/>
        <result column="domicile_place" property="domicilePlace" javaType="String"/>
        <result column="card_id_img" property="cardIdImg" javaType="String"/>
        <result column="card_id_num" property="cardIdNum" javaType="String"/>
        <result column="email" property="email" javaType="String"/>
        <result column="face_photo" property="facePhoto" javaType="String"/>
        <result column="face_add_time" property="faceAddTime" javaType="Date"/>
        <result column="bankcard_no" property="bankcardNo" javaType="String"/>
        <result column="is_certification" property="isCertification" javaType="String"/>
        <result column="ca_valid_date" property="caValidDate" javaType="Date"/>
        <result column="login_id" property="loginId" javaType="String"/>
        <result column="profile_img" property="profileImg" javaType="String"/>
        <result column="wuye_uuid" property="wuyeUuid" javaType="String"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from user_d
    where id = #{id}
  </delete>

    <delete id="deleteByUuid" parameterType="java.lang.String">
    delete from user_d
    where uuid = #{uuid}
  </delete>
    <insert id="insert" parameterType="com.app.ckxz.userb.moder.UserD">
    insert into user_d (id, uuid, user_img, 
      user_id, password, nickname, 
      phone_info, connect_mode, app_id, 
      created_time, card_id, wechat_openid, 
      wechat_unionid, app_version, last_login_time, 
      last_active_time, is_master, real_name, 
      birthday, introduce, address, 
      sex, wx_profile, dock_pkid, 
      dock_pkid2, room_number, home_address, 
      age, domicile_place, card_id_img, 
      card_id_num, email, face_photo, 
      face_add_time, bankcard_no, is_certification, 
      ca_valid_date, login_id, profile_img
      )
    values (#{id}, #{uuid}, #{userImg}, 
      #{userId}, #{password}, #{nickname}, 
      #{phoneInfo}, #{connectMode}, #{appId}, 
      #{createdTime}, #{cardId}, #{wechatOpenid}, 
      #{wechatUnionid}, #{appVersion}, #{lastLoginTime}, 
      #{lastActiveTime}, #{isMaster}, #{realName}, 
      #{birthday}, #{introduce}, #{address}, 
      #{sex}, #{wxProfile}, #{dockPkid}, 
      #{dockPkid2}, #{roomNumber}, #{homeAddress}, 
      #{age}, #{domicilePlace}, #{cardIdImg}, 
      #{cardIdNum}, #{email}, #{facePhoto}, 
      #{faceAddTime}, #{bankcardNo}, #{isCertification}, 
      #{caValidDate}, #{loginId}, #{profileImgString}
      )
  </insert>
    <update id="updateByPrimaryKey" parameterType="com.app.ckxz.userb.moder.UserD">
    update user_d
    set
      <if test="userImg!= null and userImg!= ''">
          user_img = #{userImg},
      </if>
      <if test="userId!= null and userId!= ''">
            user_id = #{userId},
      </if>
        <if test="password!= null and password!= ''">
            password = #{password},
        </if>

        <if test="nickname!= null and nickname!= ''">
            nickname = #{nickname},
        </if>

        <if test="phoneInfo!= null and phoneInfo!= ''">
            phone_info = #{phoneInfo},
        </if>

        <if test="connectMode!= null and connectMode!= ''">
            connect_mode = #{connectMode},
        </if>

        <if test="appId!= null and appId!= ''">
            app_id = #{appId},
        </if>

        <if test="createdTime!= null">
            created_time = #{createdTime},
        </if>

        <if test="cardId!= null and cardId!= ''">
            card_id = #{cardId},
        </if>

        <if test="wechatOpenid!= null and wechatOpenid!= ''">
            wechat_openid = #{wechatOpenid},
        </if>

        <if test="wechatUnionid!= null and wechatUnionid!= ''">
            wechat_unionid = #{wechatUnionid},
        </if>

        <if test="appVersion!= null and appVersion!= ''">
            app_version = #{appVersion},
        </if>

        <if test="lastLoginTime!= null">
            last_login_time = #{lastLoginTime},
        </if>

        <if test="lastActiveTime!= null">
            last_active_time = #{lastActiveTime},
        </if>

        <if test="isMaster!= null and isMaster!= ''">
            is_master = #{isMaster},
        </if>

        <if test="realName!= null and realName!= ''">
            real_name = #{realName},
        </if>

        <if test="birthday!= null">
            birthday = #{birthday},
        </if>

        <if test="introduce!= null and introduce!= ''">
            introduce = #{introduce},
        </if>

        <if test="address!= null and address!= ''">
            address = #{address},
        </if>

        <if test="sex!= null and sex!= ''">
            sex = #{sex},
        </if>

        <if test="wxProfile!= null and wxProfile!= ''">
            wx_profile = #{wxProfile},
        </if>

        <if test="dockPkid!= null and dockPkid!= ''">
            dock_pkid = #{dockPkid},
        </if>

        <if test="dockPkid2!= null and dockPkid2!= ''">
            dock_pkid2 = #{dockPkid2},
        </if>

        <if test="roomNumber!= null and roomNumber!= ''">
            room_number = #{roomNumber},
        </if>

        <if test="homeAddress!= null and homeAddress!= ''">
            home_address = #{homeAddress},
        </if>

        <if test="age!= null and age!= ''">
            age = #{age},
        </if>

        <if test="domicilePlace!= null and domicilePlace!= ''">
            domicile_place = #{domicilePlace},
        </if>

        <if test="cardIdImg!= null and cardIdImg!= ''">
            card_id_img = #{cardIdImg},
        </if>

        <if test="cardIdNum!= null and cardIdNum!= ''">
            card_id_num = #{cardIdNum},
        </if>

        <if test="email!= null and email!= ''">
            email = #{email},
        </if>

        <if test="facePhoto!= null and facePhoto!= ''">
            face_photo = #{facePhoto},
        </if>

        <if test="faceAddTime!= null">
            face_add_time = #{faceAddTime},
        </if>

        <if test="bankcardNo!= null and bankcardNo!= ''">
            bankcard_no = #{bankcardNo},
        </if>

        <if test="isCertification!= null and isCertification!= ''">
            is_certification = #{isCertification},
        </if>

        <if test="caValidDate!= null">
            ca_valid_date = #{caValidDate},
        </if>

        <if test="loginId!= null and loginId!= ''">
            login_id = #{loginId},
        </if>
        uuid = #{uuid}
    where uuid = #{uuid}
  </update>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String">
    select id, uuid, user_img, user_id, password, nickname, phone_info, connect_mode, 
    app_id, created_time, card_id, wechat_openid, wechat_unionid, app_version, last_login_time, 
    last_active_time, is_master, real_name, birthday, introduce, address, sex, wx_profile, 
    dock_pkid, dock_pkid2, room_number, home_address, age, domicile_place, card_id_img, 
    card_id_num, email, face_photo, face_add_time, bankcard_no, is_certification, ca_valid_date, 
    login_id, profile_img
    from user_d
    where uuid = #{uuid}
  </select>
    <select id="selectAll" resultMap="BaseResultMap">
    select id, uuid, user_img, user_id, password, nickname, phone_info, connect_mode, 
    app_id, created_time, card_id, wechat_openid, wechat_unionid, app_version, last_login_time, 
    last_active_time, is_master, real_name, birthday, introduce, address, sex, wx_profile, 
    dock_pkid, dock_pkid2, room_number, home_address, age, domicile_place, card_id_img, 
    card_id_num, email, face_photo, face_add_time, bankcard_no, is_certification, ca_valid_date, 
    login_id, profile_img
    from user_d
  </select>
    <select id="login" resultMap="BaseResultMap" parameterType="map">
    SELECT
        u.uuid,
        u.user_img,
        u.nickname,
        u.connect_mode,
        u.created_time,
        u.card_id,
        u.real_name,
        u.birthday,
        u.introduce,
        u.`password`,
        u.address,
        u.sex,
        u.dock_pkid,
        u.room_number,
        u.home_address,
        u.age,
        u.card_id_img,
        u.card_id_num,
        u.bankcard_no,
        u.is_certification,
        u.ca_valid_date,
        u.login_id,
        u.last_login_time,
        u.last_active_time,
        we.wuye_uuid
    FROM user_d u LEFT JOIN wuye_employee we on u.uuid = we.user_uuid and we.state = #{state}
        WHERE
            u.login_id = #{userName}
  </select>
    <select id="selectUserAll" resultMap="BaseResultMap" parameterType="map">
        SELECT
        u.uuid,
        u.user_id,
        u.user_img,
        u.`password`,
        u.nickname,
        u.created_time,
        u.domicile_place,
        u.real_name,
        u.birthday,
        u.sex,
        u.age,
        u.home_address,
        u.card_id_num,
        u.card_id_img,
        u.bankcard_no,
        u.is_certification,
        u.ca_valid_date,
        u.login_id
        from user_d u

        where 1=1
        <if test="userId != null and userId != ''">
            and u.uuid like #{userId}
        </if>
        <if test="loginId != null and loginId != ''">
            and u.login_id like #{loginId}
        </if>
        <if test="userName != null and userName != ''">
            and (u.real_name LIKE #{userName} or u.login_id LIKE #{userName} or u.card_id_num LIKE #{userName} or
            u.bankcard_no LIKE #{userName} or u.domicile_place LIKE #{userName})
        </if>
        <if test="isCardNum != null and isCardNum != '' and isCardNum == 1">
            and u.is_certification = #{isCardNum}
        </if>
        <if test="isCardNum != null and isCardNum != '' and isCardNum == 0">
            and (u.is_certification = #{isCardNum} or ISNULL(u.is_certification) or u.is_certification = '' )
        </if>
        <if test="isBrankNum != null and isBrankNum != '' and isBrankNum == 0">
            and (ISNULL(u.bankcard_no) or u.bankcard_no = '')
        </if>
        <if test="isBrankNum != null and isBrankNum != '' and isBrankNum == 1">
            and !ISNULL(u.bankcard_no) and u.bankcard_no != ''
        </if>
        <if test="sex != null and  sex != ''">
            and u.sex = #{sex}
        </if>
        ORDER BY created_time DESC
    </select>

    <select id="selectUserByUuidOrLoginId" parameterType="map" resultMap="BaseResultMap">
         select id, uuid, user_img, user_id, password, nickname, phone_info, connect_mode,
    app_id, created_time, card_id, wechat_openid, wechat_unionid, app_version, last_login_time,
    last_active_time, is_master, real_name, birthday, introduce, address, sex, wx_profile,
    dock_pkid, dock_pkid2, room_number, home_address, age, domicile_place, card_id_img,
    card_id_num, email, face_photo, face_add_time, bankcard_no, is_certification, ca_valid_date,
    login_id, profile_img
    from user_d
    <where>
        <if test="userId != null and userId != ''">
            uuid = #{userId}
        </if>
        <if test="loginId != null and loginId != ''">
            login_id = #{loginId}
        </if>
        <if test="cardIdNum != null and cardIdNum != ''">
            card_id_num = #{cardIdNum}
        </if>
        <if test="bankcardNo != null and bankcardNo != ''">
            bankcard_no = #{bankcardNo}
        </if>
    </where>
    </select>
</mapper>